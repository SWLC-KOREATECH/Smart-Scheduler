<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>일학습병행 스마트 훈련 알림 봇 가이드</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .scroll-hidden::-webkit-scrollbar { display: none; }
        .sheet-table th, .sheet-table td { border: 1px solid #e2e8f0; padding: 0.5rem; text-align: center; font-size: 0.875rem; }
        .sheet-table th { background-color: #f1f5f9; font-weight: 600; }
        .code-block { background-color: #1e293b; color: #e2e8f0; padding: 1rem; border-radius: 0.5rem; font-family: monospace; overflow-x: auto; }
        .step-card { transition: all 0.3s ease; }
        .step-card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <!-- 네비게이션 -->
    <nav class="fixed w-full bg-white/90 backdrop-blur-sm border-b border-slate-200 z-50">
        <div class="container mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <i class="fa-solid fa-robot text-blue-600 text-xl"></i>
                <span class="font-bold text-lg text-slate-800">OJT 알리미</span>
            </div>
            <div class="hidden md:flex space-x-8 text-sm font-medium text-slate-600">
                <a href="#intro" class="hover:text-blue-600 transition">소개</a>
                <a href="#features" class="hover:text-blue-600 transition">주요 기능</a>
                <a href="#guide" class="hover:text-blue-600 transition">사용 매뉴얼</a>
                <a href="#code" class="hover:text-blue-600 transition">설정 가이드</a>
            </div>
            <!-- 모바일용 메뉴 버튼 (간단 구현) -->
            <div class="md:hidden text-slate-600">
                <i class="fa-solid fa-bars text-xl"></i>
            </div>
        </div>
    </nav>

    <!-- 히어로 섹션 -->
    <section id="intro" class="pt-32 pb-20 bg-gradient-to-br from-blue-50 to-indigo-50">
        <div class="container mx-auto px-4 text-center">
            <span class="inline-block py-1 px-3 rounded-full bg-blue-100 text-blue-600 text-sm font-semibold mb-4">업무 자동화 프로젝트</span>
            <h1 class="text-4xl md:text-5xl font-bold mb-6 leading-tight text-slate-900">
                일학습병행 훈련 일정,<br>
                <span class="text-blue-600">더 이상 수동으로 공지하지 마세요</span>
            </h1>
            <p class="text-lg text-slate-600 mb-10 max-w-2xl mx-auto">
                구글 스프레드시트와 슬랙(Slack)을 연동하여<br>
                등록부터 10분 전 알림까지, 모든 과정을 자동화했습니다.
            </p>
            <div class="flex justify-center gap-4">
                <a href="#guide" class="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition shadow-lg shadow-blue-200">
                    사용법 알아보기
                </a>
                <a href="#code" class="px-6 py-3 bg-white text-slate-700 border border-slate-300 rounded-lg font-semibold hover:bg-slate-50 transition">
                    코드 설정 보기
                </a>
            </div>
        </div>
    </section>

    <!-- 문제 해결 섹션 -->
    <section class="py-20 bg-white">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <div class="space-y-6">
                    <h2 class="text-3xl font-bold text-slate-900">왜 이 시스템이 필요한가요?</h2>
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-red-100 flex items-center justify-center mt-1">
                                <i class="fa-solid fa-xmark text-red-500"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="font-bold text-slate-800">기존의 문제점</h3>
                                <p class="text-slate-600 text-sm mt-1">매번 카톡으로 공지하는 번거로움, 시간 착오로 인한 비콘 출결 누락 발생.</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-100 flex items-center justify-center mt-1">
                                <i class="fa-solid fa-check text-green-500"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="font-bold text-slate-800">도입 효과</h3>
                                <p class="text-slate-600 text-sm mt-1">일정 관리 시간 100% 단축, 10분 전 자동 알림으로 출결률 향상, 평생 무료 운영.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 시스템 구조도 -->
                <div class="bg-slate-50 p-8 rounded-2xl border border-slate-200">
                    <h3 class="text-center font-bold text-slate-500 mb-6 text-sm tracking-wider">SYSTEM ARCHITECTURE</h3>
                    <div class="flex items-center justify-between relative">
                        <!-- 연결선 -->
                        <div class="absolute top-1/2 left-0 w-full h-1 bg-slate-200 -z-10 transform -translate-y-1/2"></div>
                        
                        <!-- 노드 1 -->
                        <div class="flex flex-col items-center bg-white p-4 rounded-xl shadow-sm border border-slate-100 w-24">
                            <i class="fa-solid fa-file-csv text-green-600 text-3xl mb-2"></i>
                            <span class="text-xs font-bold">Google<br>Sheets</span>
                        </div>
                        <!-- 화살표 -->
                        <i class="fa-solid fa-chevron-right text-slate-400"></i>
                        
                        <!-- 노드 2 -->
                        <div class="flex flex-col items-center bg-white p-4 rounded-xl shadow-sm border border-slate-100 w-24">
                            <i class="fa-solid fa-gear text-slate-600 text-3xl mb-2"></i>
                            <span class="text-xs font-bold">Apps<br>Script</span>
                        </div>
                        <!-- 화살표 -->
                        <i class="fa-solid fa-chevron-right text-slate-400"></i>
                        
                        <!-- 노드 3 -->
                        <div class="flex flex-col items-center bg-white p-4 rounded-xl shadow-sm border border-slate-100 w-24">
                            <i class="fa-solid fa-calendar-days text-blue-500 text-3xl mb-2"></i>
                            <span class="text-xs font-bold">Google<br>Calendar</span>
                        </div>
                        <!-- 화살표 -->
                        <i class="fa-solid fa-chevron-right text-slate-400"></i>
                        
                        <!-- 노드 4 -->
                        <div class="flex flex-col items-center bg-white p-4 rounded-xl shadow-sm border border-slate-100 w-24">
                            <i class="fa-brands fa-slack text-purple-600 text-3xl mb-2"></i>
                            <span class="text-xs font-bold">Slack<br>Alarm</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 주요 기능 섹션 -->
    <section id="features" class="py-20 bg-slate-50">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center mb-12">주요 기능 하이라이트</h2>
            <div class="grid md:grid-cols-3 gap-8">
                <!-- 카드 1 -->
                <div class="step-card bg-white p-6 rounded-xl border border-slate-200">
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mb-4">
                        <i class="fa-solid fa-fingerprint text-blue-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">원클릭 일정 관리</h3>
                    <p class="text-slate-600 text-sm">스프레드시트에서 '등록' 버튼 한 번만 누르면 캘린더 반영 끝. 삭제도 간편하게 처리합니다.</p>
                </div>
                <!-- 카드 2 -->
                <div class="step-card bg-white p-6 rounded-xl border border-slate-200">
                    <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mb-4">
                        <i class="fa-solid fa-bullseye text-purple-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">타겟팅 알림</h3>
                    <p class="text-slate-600 text-sm">'[한기대]', '[일학습]' 등 키워드를 자동 인식하여 해당 훈련생들이 있는 슬랙 채널로만 알림을 보냅니다.</p>
                </div>
                <!-- 카드 3 -->
                <div class="step-card bg-white p-6 rounded-xl border border-slate-200">
                    <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center mb-4">
                        <i class="fa-regular fa-clock text-orange-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">10분 전 칼알림</h3>
                    <p class="text-slate-600 text-sm">24시간 자동 감시 봇이 훈련 시작 10분 전(입실), 종료 10분 전(퇴실)에 정확히 알림을 보냅니다.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 매뉴얼 섹션 -->
    <section id="guide" class="py-20 bg-white">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center mb-4">사용자 매뉴얼</h2>
            <p class="text-center text-slate-500 mb-12">담당자는 이대로만 따라 하시면 됩니다.</p>

            <div class="space-y-12">
                <!-- Step 1 -->
                <div class="flex flex-col md:flex-row gap-8 items-start">
                    <div class="md:w-1/2 bg-slate-50 p-6 rounded-xl border border-slate-200 w-full">
                        <div class="bg-white rounded shadow-sm overflow-hidden mb-4">
                            <!-- 엑셀 목업 -->
                            <table class="sheet-table w-full">
                                <thead>
                                    <tr>
                                        <th>D열(제목)</th>
                                        <th>F열(설명)</th>
                                        <th>G열(명령)</th>
                                        <th>H열(상태)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-blue-600 font-bold">[한기대] 자바</td>
                                        <td>노트북 지참</td>
                                        <td>
                                            <span class="bg-blue-100 text-blue-700 px-2 py-0.5 rounded text-xs font-bold">등록</span>
                                        </td>
                                        <td class="text-slate-400"></td>
                                    </tr>
                                    <tr>
                                        <td class="text-purple-600 font-bold">[일학습] 용접</td>
                                        <td>안전화</td>
                                        <td>
                                            <span class="bg-red-100 text-red-700 px-2 py-0.5 rounded text-xs font-bold">삭제</span>
                                        </td>
                                        <td class="text-slate-400"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="md:w-1/2 pt-4">
                        <span class="text-blue-600 font-bold text-sm tracking-wide">STEP 01</span>
                        <h3 class="text-2xl font-bold mt-2 mb-4">일정 입력 및 명령 선택</h3>
                        <p class="text-slate-600 leading-relaxed mb-4">
                            구글 시트의 <strong>A열~F열</strong>에 훈련 정보를 입력합니다.<br>
                            가장 중요한 <strong>D열(제목)</strong>에는 반드시 <code>[한기대]</code> 같은 말머리를 넣어주세요.<br>
                            그 후 <strong>G열(작업 선택)</strong>에서 <span class="text-blue-600 font-bold">'등록'</span> 또는 <span class="text-red-500 font-bold">'삭제'</span>를 선택합니다.
                        </p>
                        <ul class="list-disc list-inside text-sm text-slate-500 space-y-1">
                            <li>F열(설명)에 적은 내용은 '시작 알림' 때만 같이 전송됩니다.</li>
                            <li>빈칸이 있으면 봇이 에러를 표시합니다.</li>
                        </ul>
                    </div>
                </div>

                <!-- Step 2 -->
                <div class="flex flex-col md:flex-row-reverse gap-8 items-start">
                    <div class="md:w-1/2 bg-slate-50 p-6 rounded-xl border border-slate-200 w-full flex flex-col justify-center items-center min-h-[200px]">
                        <div class="bg-white px-4 py-2 rounded shadow border border-slate-200 mb-2">
                            <i class="fa-solid fa-calendar-check text-green-500 mr-2"></i> 📅 캘린더 매니저
                        </div>
                        <div class="bg-blue-600 text-white px-6 py-2 rounded shadow-lg transform translate-y-2 cursor-pointer hover:bg-blue-700 transition">
                            ▶️ 작업 실행하기 (등록/삭제)
                        </div>
                        <i class="fa-solid fa-arrow-pointer text-slate-800 text-2xl absolute transform translate-x-20 translate-y-8 animate-bounce"></i>
                    </div>
                    <div class="md:w-1/2 pt-4">
                        <span class="text-blue-600 font-bold text-sm tracking-wide">STEP 02</span>
                        <h3 class="text-2xl font-bold mt-2 mb-4">작업 실행 버튼 클릭</h3>
                        <p class="text-slate-600 leading-relaxed mb-4">
                            상단 메뉴바에 있는 <strong>[📅 캘린더 매니저]</strong>를 클릭하고<br>
                            <strong>[▶️ 작업 실행하기]</strong> 버튼을 누르세요.
                        </p>
                        <p class="text-slate-600 text-sm bg-yellow-50 p-3 rounded border border-yellow-200">
                            <i class="fa-solid fa-triangle-exclamation text-yellow-500 mr-1"></i>
                            최초 1회 실행 시 구글 권한 승인 팝업이 뜹니다. <br><strong>[고급] &rarr; [이동] &rarr; [허용]</strong>을 순서대로 눌러주세요.
                        </p>
                    </div>
                </div>

                <!-- Step 3 -->
                <div class="flex flex-col md:flex-row gap-8 items-start">
                    <div class="md:w-1/2 bg-slate-50 p-6 rounded-xl border border-slate-200 w-full">
                        <!-- 슬랙 목업 -->
                        <div class="bg-white p-4 rounded-lg shadow-sm border border-slate-200">
                            <div class="flex items-start mb-4">
                                <div class="w-8 h-8 rounded bg-green-500 flex items-center justify-center text-white mr-3 text-xs">bot</div>
                                <div>
                                    <div class="font-bold text-slate-800 text-sm">시간 알리미 <span class="text-slate-400 text-xs font-normal">오전 8:50</span></div>
                                    <div class="text-sm text-slate-700 mt-1">
                                        🟢 <strong>[훈련 시작 10분 전]</strong><br><br>
                                        잠시 후 <strong>'[한기대] 자바 실습'</strong> 훈련이 시작됩니다.<br>
                                        비콘 앱을 켜고 <strong>[입실]</strong> 버튼을 눌러주세요! 🏃💨
                                        <div class="border-l-4 border-slate-300 pl-2 mt-2 text-slate-500 text-xs">
                                            📌 <strong>체크 포인트</strong><br>
                                            노트북 지참
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="md:w-1/2 pt-4">
                        <span class="text-blue-600 font-bold text-sm tracking-wide">STEP 03</span>
                        <h3 class="text-2xl font-bold mt-2 mb-4">자동 알림 확인</h3>
                        <p class="text-slate-600 leading-relaxed mb-4">
                            일정이 등록되면 24시간 감시 봇이 작동합니다.<br>
                            훈련 시작/종료 <strong>10분 전</strong>에 훈련생들의 슬랙 채널로 알림이 자동 발송됩니다.
                        </p>
                        <ul class="list-disc list-inside text-sm text-slate-500 space-y-1">
                            <li>시작 알림: 🟢 초록색 (입실 독려)</li>
                            <li>종료 알림: 🔴 빨간색 (퇴실 독려)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 코드 설정 가이드 섹션 -->
    <section id="code" class="py-20 bg-slate-900 text-white">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center mb-8">🛠️ 설정 가이드 (관리자용)</h2>
            <p class="text-center text-slate-400 mb-12 max-w-2xl mx-auto">
                이 코드를 자신의 구글 시트 Apps Script에 붙여넣을 때,<br>
                아래 표시된 <strong>설정 변수 4가지</strong>만 수정하면 바로 사용할 수 있습니다.
            </p>

            <div class="max-w-4xl mx-auto">
                <div class="bg-slate-800 rounded-t-lg px-4 py-2 flex justify-between items-center border-b border-slate-700">
                    <span class="text-sm text-slate-400">config.gs</span>
                    <button onclick="copyCode()" class="text-xs bg-blue-600 hover:bg-blue-500 text-white px-3 py-1 rounded transition">
                        <i class="fa-regular fa-copy mr-1"></i> 복사하기
                    </button>
                </div>
                <pre class="code-block rounded-t-none text-sm leading-relaxed"><code id="codeSource">// 1. 일정을 등록할 '구글 캘린더의 이름' (예: '출결')
const TARGET_CALENDAR_NAME = '출결'; 

// 2. 관리자가 결과 보고를 받을 슬랙 주소
const ADMIN_WEBHOOK = 'https://hooks.slack.com/services/AAAA/BBBB/CCCC'; 

// 3. 훈련 과정별 알림을 보낼 학생용 슬랙 주소 (매핑)
const CHANNEL_MAP = {
  "한기대": "https://hooks.slack.com/services/XXXX/YYYY/ZZZZ", 
  "일학습지원단": "https://hooks.slack.com/services/DDDD/EEEE/FFFF",
  "공통": [
    "https://hooks.slack.com/services/XXXX/YYYY/ZZZZ", 
    "https://hooks.slack.com/services/DDDD/EEEE/FFFF"
  ]
};

// 4. 알림 메시지 문구 설정 ({{title}} 부분은 자동 치환됨)
const START_MSG = `🟢 *[훈련 시작 10분 전]*\n잠시 후 *'{{title}}'* 시작! 입실하세요.`;
const END_MSG   = `🔴 *[훈련 종료 10분 전]*\n잠시 후 *'{{title}}'* 종료! 퇴실하세요.`;</code></pre>
                <div class="mt-4 text-center">
                    <p class="text-sm text-slate-400">
                        <i class="fa-solid fa-circle-info mr-1"></i> 
                        코드를 붙여넣은 후 반드시 <strong>[트리거]</strong> 메뉴에서 <code>checkRealTimeAlerts</code> 함수를 <strong>1분 단위</strong>로 설정해야 합니다.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- 푸터 -->
    <footer class="bg-slate-950 text-slate-400 py-8 border-t border-slate-800">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2">일학습병행 업무 효율화 프로젝트</p>
            <p class="text-xs text-slate-600">&copy; 2025 Smart OJT Scheduler. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // 코드 복사 기능
        function copyCode() {
            const codeText = document.getElementById('codeSource').innerText;
            navigator.clipboard.writeText(codeText).then(() => {
                alert('설정 코드가 클립보드에 복사되었습니다!');
            });
        }
    </script>
</body>
</html>